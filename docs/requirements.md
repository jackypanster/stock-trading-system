# 需求文档

## 1. 项目概述

**项目名称**：美股日内套利助手 (US Stock Intraday Trading Assistant)  
**版本**：1.0.0  
**文档更新日期**：2024-12-19  
**项目目标**：开发一个专注于美股市场的个人投资助手工具，通过程序化分析识别高波动股票的日内套利机会。

## 2. 背景与动机

### 2.1 市场机会
- 美股市场部分股票具有高波动性特征，日内波动幅度较大
- 技术分析在短期交易中具有一定有效性
- 个人投资者难以同时监控多只股票的交易机会
- 情绪化交易是个人投资者的主要损失来源

### 2.2 解决方案价值
- 系统化识别日内套利机会，避免错过最佳时机
- 程序化分析减少情绪干扰，提高决策一致性
- 自动化风险控制，严格执行止损止盈策略
- 多股票同时监控，提高资金使用效率

## 3. 功能需求

### 3.1 核心功能需求

| 功能模块 | 功能描述 | 优先级 | 交付阶段 |
|---------|---------|--------|----------|
| 股票筛选 | 基于波动率和流动性筛选适合日内交易的股票 | P0 | MVP |
| 实时监控 | 获取股票实时价格和市场数据 | P0 | MVP |
| 技术分析 | 计算支撑阻力位、RSI、MACD等技术指标 | P0 | MVP |
| 信号生成 | 基于技术分析生成买卖信号 | P0 | MVP |
| 风险控制 | 仓位管理、止损止盈自动计算 | P0 | MVP |
| 持仓管理 | 跟踪当前持仓和盈亏状况 | P1 | V1.1 |
| 交易记录 | 记录历史交易和信号执行情况 | P1 | V1.1 |
| 策略回测 | 使用历史数据验证策略有效性 | P1 | V1.2 |
| 报告生成 | 生成日内交易分析报告 | P2 | V1.3 |
| 消息通知 | 重要信号的邮件或消息提醒 | P2 | V1.3 |

### 3.2 详细功能说明

#### 3.2.1 股票筛选功能
**功能描述**：动态筛选和维护适合日内套利的股票池
- 基于日均成交量、波动率、价格区间等条件筛选
- 支持手动添加/移除股票
- 自动评估股票表现，动态调整股票池
- 提供股票池管理界面

**输入**：筛选条件、市场数据
**输出**：符合条件的股票列表
**验收标准**：能够从3000+美股中筛选出10-20只符合条件的股票

#### 3.2.2 技术分析功能
**功能描述**：计算多种技术指标，识别交易机会
- 支撑阻力位自动识别（动态计算，非固定数值）
- 技术指标计算：RSI、MACD、移动平均线、ATR等
- 价格形态识别：突破、回调等
- 成交量分析：成交量确认信号

**输入**：历史价格数据、配置参数
**输出**：技术指标数值、支撑阻力位
**验收标准**：指标计算准确性99%+，支撑阻力位识别有效性60%+

#### 3.2.3 信号生成功能
**功能描述**：基于技术分析结果生成具体的买卖建议
- 多因子信号合成：结合多个技术指标
- 信号置信度评估：0-1的置信度评分
- 入场点位建议：具体的买入/卖出价格
- 止损止盈设置：自动计算止损止盈位

**输入**：技术指标、当前价格、配置参数
**输出**：交易信号（买入/卖出/持有）
**验收标准**：日均生成3-5个有效信号，信号准确率60%+

#### 3.2.4 风险控制功能
**功能描述**：确保交易风险在可控范围内
- 单股票最大仓位限制（如15%）
- 日内最大交易次数限制
- 自动止损机制（如2%止损）
- 分层止盈策略
- 连续亏损暂停机制

**输入**：信号、当前持仓、风险参数
**输出**：风险评估结果、调整后的交易建议
**验收标准**：单日最大亏损不超过设定阈值，风险控制100%有效

### 3.3 用户界面需求

#### 3.3.1 命令行界面（CLI）
- 快速查询：当前持仓、今日信号、股票分析
- 批量操作：分析多只股票、生成报告
- 配置管理：修改股票配置、系统参数
- 日志查看：查看系统运行日志

#### 3.3.2 Web界面（可选）
- 仪表板：实时显示持仓、盈亏、信号
- 股票详情：单只股票的详细分析页面
- 历史记录：交易历史、信号历史查看
- 配置界面：图形化配置管理

## 4. 非功能需求

### 4.1 性能需求

| 指标 | 要求 | 测量方法 |
|------|------|----------|
| 响应时间 | 单只股票分析 < 2秒 | 压力测试 |
| 吞吐量 | 同时分析10只股票 < 10秒 | 性能测试 |
| 内存使用 | 运行时内存 < 500MB | 监控工具 |
| 数据更新 | 价格数据延迟 < 5分钟 | 数据源对比 |

### 4.2 可靠性需求

| 指标 | 要求 | 保障措施 |
|------|------|----------|
| 系统可用性 | 99% (交易时间内) | 异常处理、自动重启 |
| 数据准确性 | 99.9% | 多数据源验证 |
| 故障恢复 | 自动恢复 < 5分钟 | 健康检查、重试机制 |

### 4.3 安全性需求
- API密钥安全存储（环境变量）
- 本地数据库文件加密（可选）
- 不存储敏感的账户信息
- 明确风险提示，不提供投资建议

### 4.4 可扩展性需求
- 支持新增股票配置（无需修改代码）
- 支持新增技术指标（插件化）
- 支持新增数据源（接口抽象）
- 支持数据库升级（SQLite → PostgreSQL）

### 4.5 易用性需求
- 零配置启动（使用默认设置）
- 一键安装依赖
- 清晰的错误提示和日志
- 完整的使用文档

## 5. 约束条件

### 5.1 技术约束
- 编程语言：Python 3.9+
- 数据源：免费/低成本API（yfinance, Alpha Vantage等）
- 部署环境：个人电脑、本地运行
- 数据存储：本地文件系统

### 5.2 业务约束
- 仅提供交易建议，不执行实际交易
- 不提供投资建议，用户自主决策
- 遵守相关法律法规
- 明确风险提示

### 5.3 时间约束
- MVP版本：4周开发周期
- 核心功能优先：技术分析和信号生成
- 迭代开发：逐步增加高级功能

### 5.4 资源约束
- 个人开发项目，人力资源有限
- 使用免费数据源，避免高昂API费用
- 硬件要求适中，普通个人电脑可运行

## 6. 用户故事

### 6.1 主要用户角色
**个人投资者 (Primary User)**
- 有一定投资经验的个人
- 关注美股市场
- 希望提高交易效率和收益
- 需要工具辅助决策

### 6.2 核心用户故事

```gherkin
故事1：查看今日交易机会
作为一个个人投资者
我希望快速查看今日有哪些交易机会
以便我能及时做出投资决策

Given 我启动了交易助手系统
When 我执行"python main.py --today-signals"命令
Then 我应该看到今日所有股票的交易信号
And 信号按置信度排序
And 显示具体的买入/卖出建议价格

故事2：分析特定股票
作为一个个人投资者
我希望深入分析某只我关注的股票
以便我了解其技术面情况

Given 我想分析TSLA股票
When 我执行"python main.py --analyze TSLA"命令
Then 我应该看到TSLA的详细技术分析
And 包括当前价格、支撑阻力位、技术指标
And 包括具体的交易建议和风险评估

故事3：管理投资组合
作为一个个人投资者
我希望跟踪我的持仓情况
以便我了解当前的盈亏状况

Given 我已有一些持仓
When 我执行"python main.py --portfolio"命令
Then 我应该看到所有持仓的详细信息
And 包括每只股票的持仓数量、成本、当前价值
And 包括总体的盈亏情况
```

## 7. 验收标准

### 7.1 MVP版本验收标准
- [ ] 能够成功筛选出10只适合日内交易的美股
- [ ] 能够实时获取股票价格数据（延迟<5分钟）
- [ ] 能够计算基础技术指标（RSI、MACD、支撑阻力位）
- [ ] 能够生成买卖信号，置信度评估合理
- [ ] 能够执行基础风险控制（止损、仓位限制）
- [ ] 具备完整的CLI界面，支持基本操作
- [ ] 系统稳定运行，无严重bug
- [ ] 提供完整的安装和使用文档

### 7.2 性能验收标准
- [ ] 单只股票分析时间 < 2秒
- [ ] 10只股票批量分析时间 < 10秒
- [ ] 系统内存占用 < 500MB
- [ ] 连续运行24小时无崩溃

### 7.3 质量验收标准
- [ ] 代码测试覆盖率 > 80%
- [ ] 所有核心功能有单元测试
- [ ] 集成测试通过
- [ ] 代码符合PEP8规范
- [ ] 文档完整，包括API文档和用户手册

## 8. 风险评估

### 8.1 技术风险
| 风险 | 概率 | 影响 | 缓解措施 |
|------|------|------|----------|
| 数据源不稳定 | 中 | 高 | 多数据源备份 |
| 算法准确性不足 | 中 | 中 | 充分回测验证 |
| 性能不达标 | 低 | 中 | 早期性能测试 |

### 8.2 业务风险
| 风险 | 概率 | 影响 | 缓解措施 |
|------|------|------|----------|
| 法律合规问题 | 低 | 高 | 明确免责声明 |
| 用户损失责任 | 中 | 高 | 强调风险提示 |
| 市场环境变化 | 高 | 中 | 策略参数可调 |

## 9. 项目里程碑

### 9.1 开发阶段规划

**阶段一：核心MVP (Week 1-2)**
- 基础项目结构搭建
- 数据获取模块开发
- 基础技术分析功能
- 简单信号生成

**阶段二：完善功能 (Week 3-4)**
- 风险控制模块
- CLI界面完善
- 配置管理系统
- 基础测试

**阶段三：优化与测试 (Week 5-6)**
- 性能优化
- 全面测试
- 文档完善
- 用户验收测试

**阶段四：发布准备 (Week 7-8)**
- Bug修复
- 最终测试
- 部署文档
- 用户手册
